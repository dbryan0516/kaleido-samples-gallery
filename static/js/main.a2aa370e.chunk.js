(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e){e.exports={abi:'[{"constant":true,"inputs":[],"name":"storedData","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"x","type":"string"}],"name":"set","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"get","outputs":[{"name":"retVal","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"initVal","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]',bytecode:"608060405234801561001057600080fd5b5060405161044038038061044083398101604052805101805161003a906000906020840190610041565b50506100dc565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061008257805160ff19168380011785556100af565b828001600101855582156100af579182015b828111156100af578251825591602001919060010190610094565b506100bb9291506100bf565b5090565b6100d991905b808211156100bb57600081556001016100c5565b90565b610355806100eb6000396000f3006080604052600436106100565763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416632a1afcd9811461005b5780634ed3885e146100e55780636d4ce63c14610140575b600080fd5b34801561006757600080fd5b50610070610155565b6040805160208082528351818301528351919283929083019185019080838360005b838110156100aa578181015183820152602001610092565b50505050905090810190601f1680156100d75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156100f157600080fd5b506040805160206004803580820135601f810184900484028501840190955284845261013e9436949293602493928401919081908401838280828437509497506101e39650505050505050565b005b34801561014c57600080fd5b506100706101fa565b6000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156101db5780601f106101b0576101008083540402835291602001916101db565b820191906000526020600020905b8154815290600101906020018083116101be57829003601f168201915b505050505081565b80516101f6906000906020840190610291565b5050565b60008054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156102865780601f1061025b57610100808354040283529160200191610286565b820191906000526020600020905b81548152906001019060200180831161026957829003601f168201915b505050505090505b90565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106102d257805160ff19168380011785556102ff565b828001600101855582156102ff579182015b828111156102ff5782518255916020019190600101906102e4565b5061030b92915061030f565b5090565b61028e91905b8082111561030b57600081556001016103155600a165627a7a7230582070960dda9dcda940cebe061050064343c926fd0f1b478822d2deebe9a60db8890029",functionHashes:{"get()":"6d4ce63c","set(string)":"4ed3885e","storedData()":"2a1afcd9"},gasEstimates:{creation:[null,170600],external:{"get()":null,"set(string)":null,"storedData()":null},internal:{}},runtimeBytecode:"6080604052600436106100565763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416632a1afcd9811461005b5780634ed3885e146100e55780636d4ce63c14610140575b600080fd5b34801561006757600080fd5b50610070610155565b6040805160208082528351818301528351919283929083019185019080838360005b838110156100aa578181015183820152602001610092565b50505050905090810190601f1680156100d75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156100f157600080fd5b506040805160206004803580820135601f810184900484028501840190955284845261013e9436949293602493928401919081908401838280828437509497506101e39650505050505050565b005b34801561014c57600080fd5b506100706101fa565b6000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156101db5780601f106101b0576101008083540402835291602001916101db565b820191906000526020600020905b8154815290600101906020018083116101be57829003601f168201915b505050505081565b80516101f6906000906020840190610291565b5050565b60008054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156102865780601f1061025b57610100808354040283529160200191610286565b820191906000526020600020905b81548152906001019060200180831161026957829003601f168201915b505050505090505b90565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106102d257805160ff19168380011785556102ff565b828001600101855582156102ff579182015b828111156102ff5782518255916020019190600101906102e4565b5061030b92915061030f565b5090565b61028e91905b8082111561030b57600081556001016103155600a165627a7a7230582070960dda9dcda940cebe061050064343c926fd0f1b478822d2deebe9a60db8890029"}},188:function(e){e.exports={abi:'[{"constant":true,"inputs":[],"name":"get","outputs":[{"name":"","type":"string"},{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"Description","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"IpfsHash","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"description","type":"string"},{"name":"ipfsHash","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]',bytecode:"608060405234801561001057600080fd5b506040516105483803806105488339810160405280516020808301519183018051909392909201916100489160009190850190610064565b50805161005c906001906020840190610064565b5050506100ff565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100a557805160ff19168380011785556100d2565b828001600101855582156100d2579182015b828111156100d25782518255916020019190600101906100b7565b506100de9291506100e2565b5090565b6100fc91905b808211156100de57600081556001016100e8565b90565b61043a8061010e6000396000f3006080604052600436106100565763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416636d4ce63c811461005b5780638191745f1461014e5780638bf421ee146101d8575b600080fd5b34801561006757600080fd5b506100706101ed565b604051808060200180602001838103835285818151815260200191508051906020019080838360005b838110156100b1578181015183820152602001610099565b50505050905090810190601f1680156100de5780820380516001836020036101000a031916815260200191505b50838103825284518152845160209182019186019080838360005b838110156101115781810151838201526020016100f9565b50505050905090810190601f16801561013e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b34801561015a57600080fd5b50610163610326565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561019d578181015183820152602001610185565b50505050905090810190601f1680156101ca5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156101e457600080fd5b506101636103b4565b60608060006001818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156102895780601f1061025e57610100808354040283529160200191610289565b820191906000526020600020905b81548152906001019060200180831161026c57829003601f168201915b5050845460408051602060026001851615610100026000190190941693909304601f8101849004840282018401909252818152959750869450925084019050828280156103175780601f106102ec57610100808354040283529160200191610317565b820191906000526020600020905b8154815290600101906020018083116102fa57829003601f168201915b50505050509050915091509091565b6000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156103ac5780601f10610381576101008083540402835291602001916103ac565b820191906000526020600020905b81548152906001019060200180831161038f57829003601f168201915b505050505081565b60018054604080516020600284861615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156103ac5780601f10610381576101008083540402835291602001916103ac5600a165627a7a72305820d7adc0e9340cd146407cdaaa9fd40fc80140ad68ebc040afaf909bf9885ddb010029",functionHashes:{"Description()":"8191745f","IpfsHash()":"8bf421ee","get()":"6d4ce63c"},gasEstimates:{creation:[null,216400],external:{"Description()":null,"IpfsHash()":null,"get()":null},internal:{}},runtimeBytecode:"6080604052600436106100565763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416636d4ce63c811461005b5780638191745f1461014e5780638bf421ee146101d8575b600080fd5b34801561006757600080fd5b506100706101ed565b604051808060200180602001838103835285818151815260200191508051906020019080838360005b838110156100b1578181015183820152602001610099565b50505050905090810190601f1680156100de5780820380516001836020036101000a031916815260200191505b50838103825284518152845160209182019186019080838360005b838110156101115781810151838201526020016100f9565b50505050905090810190601f16801561013e5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b34801561015a57600080fd5b50610163610326565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561019d578181015183820152602001610185565b50505050905090810190601f1680156101ca5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156101e457600080fd5b506101636103b4565b60608060006001818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156102895780601f1061025e57610100808354040283529160200191610289565b820191906000526020600020905b81548152906001019060200180831161026c57829003601f168201915b5050845460408051602060026001851615610100026000190190941693909304601f8101849004840282018401909252818152959750869450925084019050828280156103175780601f106102ec57610100808354040283529160200191610317565b820191906000526020600020905b8154815290600101906020018083116102fa57829003601f168201915b50505050509050915091509091565b6000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156103ac5780601f10610381576101008083540402835291602001916103ac565b820191906000526020600020905b81548152906001019060200180831161038f57829003601f168201915b505050505081565b60018054604080516020600284861615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156103ac5780601f10610381576101008083540402835291602001916103ac5600a165627a7a72305820d7adc0e9340cd146407cdaaa9fd40fc80140ad68ebc040afaf909bf9885ddb010029"}},357:function(e,t,a){e.exports=a(718)},362:function(e,t,a){},399:function(e,t){},401:function(e,t){},426:function(e,t){},443:function(e,t){},445:function(e,t){},476:function(e,t){},552:function(e,t,a){},718:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(83),c=a.n(l),o=(a(362),a(33)),s=a(34),i=a(36),f=a(35),d=a(37),m=a(736),u=a(727),p=a(737),b=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).updateLocalStorage=function(){localStorage.setItem("consortiaId",a.consortiaId.current.value),localStorage.setItem("appCredsUsername",a.appCredsUsername.current.value),localStorage.setItem("appCredsPassword",a.appCredsPassword.current.value),localStorage.setItem("nodeRpcEndpoint",a.nodeRpcEndpoint.current.value),localStorage.setItem("hdwalletRpcEndpoint",a.hdwalletRpcEndpoint.current.value),localStorage.setItem("hdwalletWalletId",a.hdwalletWalletId.current.value),localStorage.setItem("ipfsRpcEndpoint",a.ipfsRpcEndpoint.current.value),localStorage.setItem("openlawRpcEndpoint",a.openlawRpcEndpoint.current.value),localStorage.setItem("openlawAccountEmail",a.openlawAccountEmail.current.value),localStorage.setItem("openlawAccountPassword",a.openlawAccountPassword.current.value),localStorage.setItem("idRegistryRpcEndpoint",a.idRegistryRpcEndpoint.current.value),alert("latest settings saved!")},a.consortiaId=r.a.createRef(),a.appCredsUsername=r.a.createRef(),a.appCredsPassword=r.a.createRef(),a.nodeRpcEndpoint=r.a.createRef(),a.hdwalletRpcEndpoint=r.a.createRef(),a.hdwalletWalletId=r.a.createRef(),a.ipfsRpcEndpoint=r.a.createRef(),a.openlawRpcEndpoint=r.a.createRef(),a.openlawAccountEmail=r.a.createRef(),a.openlawAccountPassword=r.a.createRef(),a.idRegistryRpcEndpoint=r.a.createRef(),a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.consortiaId.current.value=localStorage.getItem("consortiaId"),this.appCredsUsername.current.value=localStorage.getItem("appCredsUsername"),this.appCredsPassword.current.value=localStorage.getItem("appCredsPassword"),this.nodeRpcEndpoint.current.value=localStorage.getItem("nodeRpcEndpoint"),this.hdwalletRpcEndpoint.current.value=localStorage.getItem("hdwalletRpcEndpoint"),this.hdwalletWalletId.current.value=localStorage.getItem("hdwalletWalletId"),this.ipfsRpcEndpoint.current.value=localStorage.getItem("ipfsRpcEndpoint"),this.openlawRpcEndpoint.current.value=localStorage.getItem("openlawRpcEndpoint"),this.openlawAccountEmail.current.value=localStorage.getItem("openlawAccountEmail"),this.openlawAccountPassword.current.value=localStorage.getItem("openlawAccountPassword"),this.idRegistryRpcEndpoint.current.value=localStorage.getItem("idRegistryRpcEndpoint")}},{key:"render",value:function(){var e=this;return r.a.createElement("main",{className:"container"},r.a.createElement("h2",null,"Configure"),r.a.createElement("h5",null,"This is needed so the samples can connect to your Kaleido environment. All information will be persisted to browser local storage."),r.a.createElement("br",null),r.a.createElement("h5",null,"Shared"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Consortia ID"),r.a.createElement("div",{className:"col-sm-4"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.consortiaId}),r.a.createElement("small",null,"(ex: zzabcd1234)"))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"App credentials username"),r.a.createElement("div",{className:"col-sm-4"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.appCredsUsername}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"App credentials password"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"password",className:"form-control col-sm-12",ref:this.appCredsPassword}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Node RPC endpoint"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.nodeRpcEndpoint}),r.a.createElement("small",null,"(ex: https://zz..-zz..-rpc.us-east-2.kaleido.io)"))),r.a.createElement("h5",null,"HDWallet"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"HDWallet RPC endpoint"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.hdwalletRpcEndpoint}),r.a.createElement("small",null,"(ex: https://zz..-zz..-hdwallet.us-east-2.kaleido.io)"))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"HDWallet wallet ID"),r.a.createElement("div",{className:"col-sm-4"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.hdwalletWalletId}))),r.a.createElement("h5",null,"IPFS"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"IPFS RPC endpoint"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.ipfsRpcEndpoint}),r.a.createElement("small",null,"(ex: https://zz..-zz..-ipfs.us-east-2.kaleido.io)"))),r.a.createElement("h5",null,"ID Registry"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"ID Registry RPC endpoint"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.idRegistryRpcEndpoint}),r.a.createElement("small",null,"(ex: https://zz..-zz..-idregistry.us-east-2.kaleido.io)"))),r.a.createElement("h5",null,"OpenLaw"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"OpenLaw RPC endpoint"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.openlawRpcEndpoint}),r.a.createElement("small",null,"(ex: https://zz..-zz..-openlaw.us-east-2.kaleido.io)"))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"OpenLaw account email"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",ref:this.openlawAccountEmail}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"OpenLaw account password"),r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{type:"password",className:"form-control col-sm-12",ref:this.openlawAccountPassword}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return e.updateLocalStorage()}},"Save"))))}}]),t}(n.Component),h=a(19),g=a.n(h),E=a(38),y=a(18),w=a(187),v=a(323),C=a.n(v),N={bindLocalStorage:function(e){e.consortiaId=localStorage.getItem("consortiaId"),e.appCredsUsername=localStorage.getItem("appCredsUsername"),e.appCredsPassword=localStorage.getItem("appCredsPassword"),e.nodeRpcEndpoint=localStorage.getItem("nodeRpcEndpoint"),e.hdwalletRpcEndpoint=localStorage.getItem("hdwalletRpcEndpoint"),e.hdwalletWalletId=localStorage.getItem("hdwalletWalletId"),e.ipfsRpcEndpoint=localStorage.getItem("ipfsRpcEndpoint"),e.openlawRpcEndpoint=localStorage.getItem("openlawRpcEndpoint"),e.openlawAccountEmail=localStorage.getItem("openlawAccountEmail"),e.openlawAccountPassword=localStorage.getItem("openlawAccountPassword"),e.idRegistryRpcEndpoint=localStorage.getItem("idRegistryRpcEndpoint")},buildWeb3:function(e){e.appCredsUsername&&e.appCredsPassword&&e.nodeRpcEndpoint&&S.buildWeb3(e)},getContract:function(e,t,a,n){var r=JSON.parse(t.abi),l="0x"+t.bytecode;try{var c=new e.eth.Contract(r,a);return a||(c=c.deploy({data:l,arguments:n})),c}catch(o){console.error("Failed to get contract",o)}return null},buildServiceUrlWithCreds:function(e,t){var a=t.startsWith("http://")?"http://":"https://";return"".concat(a).concat(e.appCredsUsername,":").concat(e.appCredsPassword,"@").concat(t.replace(a,""))}},S={buildWeb3:function(e){e.web3=new C.a(N.buildServiceUrlWithCreds(e,e.nodeRpcEndpoint))}},A=N;var O=function(e){return r.a.createElement("main",null,r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,e.header),"missing\xa0",r.a.createElement(u.a,{to:"/"},"config"),r.a.createElement("p",null,e.text)))},x=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.consortiaId&&a.appCredsUsername&&a.appCredsPassword&&a.nodeRpcEndpoint&&a.hdwalletRpcEndpoint&&a.hdwalletWalletId?(a.blockExplorerUrl=a.nodeRpcEndpoint.endsWith("dev.photic.io")?"explorer-dev.photic.io":"explorer.kaleido.io",a.setState(function(){return{msg:"Sample message"}})):a.setState(function(){return{missingConfig:!0}})},a.msgChanged=function(e){var t=e.target.value;a.setState(function(){return{msg:t}})},a.lockMsg=function(){a.setState(function(){return{locked:!0}})},a.fetchHdwallet=function(){a.setState(function(){return{hdwalletAddress:"",hdwalletPrivateKey:"",fetchingHdwalletIndex:!0}},Object(E.a)(g.a.mark(function e(){var t;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.hasHdwalletIndex()){e.next=5;break}return e.next=3,a.getHdwalletAccount(a.state.hdwalletIndex);case 3:t=e.sent,a.setState(function(){return{hdwalletAddress:t.address,hdwalletPrivateKey:t.privateKey,fetchingHdwalletIndex:!1}});case 5:case"end":return e.stop()}},e,this)})))},a.hasHdwalletIndex=function(){return a.state.hdwalletIndex&&a.state.hdwalletIndex>=0},a.hdwalletIndexChanged=function(e){var t=e.target.value;a.setState(function(){return{hdwalletIndex:t}})},a.deployingContract=function(){a.setState(function(){return{contractDeploying:!0}},function(){return a.deployContract()})},a.deployContract=function(){var e={gas:5e8,data:A.getContract(a.web3,w,"",[a.state.msg]).encodeABI()};a.web3.eth.accounts.signTransaction(e,"0x".concat(a.state.hdwalletPrivateKey)).then(function(e){a.web3.eth.sendSignedTransaction(e.rawTransaction).on("receipt",function(e){console.log(e)}).on("error",function(e){console.error("Failed to deploy the smart contract. Error: "+e)}).then(function(e){console.log(e),console.log("\tSmart contract deployed, ready to take calls at '".concat(e.contractAddress,"'")),a.setState(function(){return{contractAddress:e.contractAddress,contractFrom:e.from,transactionHash:e.transactionHash}})})})},a.getContractValue=function(){A.getContract(a.web3,w,a.state.contractAddress,[]).methods.get().call().then(function(e){console.log("\tSmart contract current state: %j",e),a.setState(function(){return{contractValue:e}})})},a.getHdwalletAccount=function(e){console.log("fetching hd wallet account to use");var t=new Headers;return t.append("Authorization","Basic "+btoa(a.appCredsUsername+":"+a.appCredsPassword)),t.append("content-type","application/json"),t.append("Accept","application/json, text/plain, */*"),fetch("".concat(a.hdwalletRpcEndpoint,"/api/v1/wallets/").concat(a.hdwalletWalletId,"/accounts/").concat(e),{method:"GET",headers:t}).then(function(e){return e.json()})},A.bindLocalStorage(Object(y.a)(Object(y.a)(a))),A.buildWeb3(Object(y.a)(Object(y.a)(a))),a.state={missingConfig:!1,msg:"",locked:!1,hdwalletAddress:"",hdwalletPrivateKey:"",hdwalletIndex:"",fetchingHdwalletIndex:!1,contractDeploying:!1,contractAddress:"",contractFrom:"",contractValue:"",transactionHash:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.missingConfig?r.a.createElement(O,{header:"HDWallet"}):r.a.createElement("main",{className:"container"},r.a.createElement("h2",null,"HDWallet"),r.a.createElement("h5",null,"The purpose of this sample is to show how you can anonymously submit a transaction to the blockchain. We will deploy a simple smart contract which stores and exposes a single value."),r.a.createElement("br",null),r.a.createElement("h6",null,"Step 1: Enter a message. This message is the value that will be included in the smart contract when we deploy it in the next step."),r.a.createElement("div",null,r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Message"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("textarea",{disabled:this.state.locked,onChange:this.msgChanged,className:"form-control",rows:"2",value:this.state.msg})),this.state.locked?null:r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{disabled:!this.state.msg,type:"button",className:"btn btn-primary",onClick:function(){return e.lockMsg()}},"Next"))),this.state.locked?r.a.createElement("div",null,r.a.createElement("h6",null,"Step 2: Let's choose an account generated by your HDWallet to sign the transaction that deploys our contract containing the above message."),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"HDWallet account index"),r.a.createElement("div",{className:"col-sm-2"},r.a.createElement("input",{type:"number",min:"0",max:"10000",className:"form-control col-sm-12",disabled:this.state.contractDeploying,value:this.state.hdwalletIndex,onChange:this.hdwalletIndexChanged})),this.state.contractDeploying?null:r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{disabled:this.state.fetchingHdwalletIndex||!this.hasHdwalletIndex(),type:"button",className:"btn btn-primary",onClick:function(){return e.fetchHdwallet()}},"Fetch HDWallet account"))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"HDWallet address"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:!0,value:this.state.hdwalletAddress}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"HDWallet signing key"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:!0,value:this.state.hdwalletPrivateKey})),!this.state.contractDeploying&&this.state.hdwalletAddress&&this.state.hdwalletPrivateKey?r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return e.deployingContract()}},"Deploy to blockchain!")):null,this.state.contractDeploying&&!this.state.contractAddress?r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",disabled:!0,className:"btn btn-success"},"Deploying to blockchain...")):null)):null,this.state.contractAddress?r.a.createElement("div",null,r.a.createElement("h6",null,"Step 3: Congrats!",r.a.createElement("br",null),"The contract has been deployed to the following address: ",r.a.createElement("i",null,this.state.contractAddress),".",r.a.createElement("br",null),"On the blockchain ledger, this",r.a.createElement("a",{target:"blank",href:"https://".concat(this.blockExplorerUrl,"/tx/").concat(this.state.transactionHash,"?consortia=").concat(this.consortiaId,"&environment=").concat(this.nodeRpcEndpoint.substr(8,10))}," transaction "),"shows that it originated from ",r.a.createElement("i",null,this.state.contractFrom),". Notice that this is the account you chose to use from your HDWallet and ",r.a.createElement("b",null,"not")," your Kaleido node's account address. For future transactions, you can sequentially iterate through the wallet accounts and obtain a different signing key for every transaction. For complete anonymity you should never use a signing key more than once."),r.a.createElement("br",null),r.a.createElement("h6",null,"Step 4: Verification - lets query the contract's value"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Contract value"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:!0,value:this.state.contractValue})),this.state.contractValue?null:r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return e.getContractValue()}},"Get contract value"))),this.state.contractValue?r.a.createElement("h6",null,"Conclusion: Notice that the value stored in the blockchain contract matches your message above."):null):null))}}]),t}(n.Component),I=a(188),R=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.appCredsUsername&&a.appCredsPassword&&a.nodeRpcEndpoint&&a.ipfsRpcEndpoint||a.setState(function(){return{missingConfig:!0}})},a.fileChangedHandler=function(e){var t=e.target.files[0];t?a.setState(function(){return{selectedFile:t}}):a.setState(function(){return{selectedFile:null}})},a.uploadToIpfs=function(){a.setState(function(){return{uploadingFile:!0}},function(){var e=new Headers;e.append("Authorization","Basic "+btoa(a.appCredsUsername+":"+a.appCredsPassword)),e.append("Accept","application/json, text/plain, */*");var t=new FormData;t.append("blob",a.state.selectedFile),fetch("".concat(a.ipfsRpcEndpoint,"/api/v0/add"),{method:"POST",headers:e,body:t}).then(function(e){return e.json()}).then(function(e){console.log(e);var t=A.buildServiceUrlWithCreds(Object(y.a)(Object(y.a)(a)),"".concat(a.ipfsRpcEndpoint,"/api/v0"));a.setState(function(){return{ipfsHash:e.Hash,ipfsLink:"".concat(t,"/cat/").concat(e.Hash),uploadedFile:!0,uploadingFile:!1}})})})},a.fileDescriptionChanged=function(e){var t=e.target.value;a.setState(function(){return{fileDescription:t}})},a.deployingContract=function(){a.setState(function(){return{contractDeploying:!0}},function(){return a.deployContract()})},a.getContractValues=function(){A.getContract(a.web3,I,a.state.contractAddress,[]).methods.get().call().then(function(e){console.log("\tSmart contract current state: %j",e),a.setState(function(){return{contractFileDescription:e[0],contractIpfsHash:e[1]}})})},a.downloadFile=function(){var e=new Headers;e.append("Authorization","Basic "+btoa(a.appCredsUsername+":"+a.appCredsPassword)),e.append("Accept","application/json, text/plain, */*");var t="".concat(a.ipfsRpcEndpoint,"/api/v0/get/").concat(a.state.ipfsHash);fetch(t,{method:"GET",headers:e})},A.bindLocalStorage(Object(y.a)(Object(y.a)(a))),A.buildWeb3(Object(y.a)(Object(y.a)(a))),a.state={missingConfig:!1,selectedFile:null,uploadingFile:!1,uploadedFile:!1,ipfsHash:"",ipfsLink:"",fileDescription:"",contractDeploying:!1,contractAddress:"",contractFileDescription:"",contractIpfsHash:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"deployContract",value:function(){var e=Object(E.a)(g.a.mark(function e(){var t,a,n,r,l=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.web3.eth.personal.getAccounts();case 2:t=e.sent,a=A.getContract(this.web3,I,"",[this.state.fileDescription,this.state.ipfsHash]),n=a.encodeABI(),r={from:t[0],gas:5e8,data:n},this.web3.eth.sendTransaction(r).on("receipt",function(e){console.log(e)}).on("error",function(e){console.error("Failed to deploy the smart contract. Error: "+e)}).then(function(e){console.log(e),console.log("\tSmart contract deployed, ready to take calls at '".concat(e.contractAddress,"'")),l.setState(function(){return{contractAddress:e.contractAddress}})});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.missingConfig?r.a.createElement(O,{header:"IPFS"}):r.a.createElement("main",{className:"container"},r.a.createElement("h2",null,"IPFS"),r.a.createElement("h5",null,"The purpose of this sample is to show how you can add a file to IPFS, and then store a description of the file along with the IPFS content hash in a blockchain smart contract. This is a popular pattern for storing large amounts of data off-chain (in IPFS) and storing the reference (IPFS content hash) of where the data is located on-chain."),r.a.createElement("br",null),r.a.createElement("h6",null,"Step 1: Add a file to IPFS and retrieve the IPFS hash back once it's been added."),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Upload a file"),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("input",{disabled:this.state.uploadedFile,type:"file",onChange:this.fileChangedHandler,ref:this.fileRef})),this.state.uploadedFile?null:r.a.createElement("div",{className:"col-sm-5"},r.a.createElement("button",{disabled:!this.state.selectedFile||this.state.uploadingFile,type:"button",className:"btn btn-primary",onClick:function(){return e.uploadToIpfs()}},"Upload file"))),this.state.uploadedFile?r.a.createElement("div",null,r.a.createElement("h6",null,"Step 2: The file has been added to IPFS with the following content hash: ",r.a.createElement("i",null,this.state.ipfsHash),".",r.a.createElement("br",null)," Enter a friendly file description for this file and then we can deploy the smart contract containing the description and IPFS content hash."),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"File description"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:this.state.contractDeploying,onChange:this.fileDescriptionChanged,value:this.state.fileDescription})),this.state.contractDeploying?null:r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{disabled:!this.state.fileDescription,type:"button",className:"btn btn-success",onClick:function(){return e.deployingContract()}},"Deploy to blockchain!")),this.state.contractDeploying&&!this.state.contractAddress?r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",disabled:!0,className:"btn btn-success"},"Deploying to blockchain...")):null)):null,this.state.contractAddress?r.a.createElement("div",null,r.a.createElement("h6",null,"Step 3: Congrats!",r.a.createElement("br",null),"The contract has been deployed to the following address: ",r.a.createElement("i",null,this.state.contractAddress),"."),r.a.createElement("br",null),r.a.createElement("h6",null,"Step 4: Verification - lets query the contract's values"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"File description"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:!0,value:this.state.contractFileDescription}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"IPFS content hash"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("input",{type:"text",className:"form-control col-sm-12",readOnly:!0,value:this.state.contractIpfsHash})),this.state.contractFileDescription||this.state.contractIpfsHash?null:r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return e.getContractValues()}},"Get contract values")))):null,this.state.contractFileDescription&&this.state.contractIpfsHash?r.a.createElement("div",null,r.a.createElement("h6",null,"Conclusion: Download file from IPFS using the IPFS content hash"),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("a",{href:this.state.ipfsLink,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary"},"Download file"))):null)}}]),t}(n.Component),k=a(728),D=a(719),P=a(740),j=a(739),L=a(733),F=a(731),H=a(738),T=a(734),M=a(730),z=a(735),W=a(732),U=(a(552),a(85));function B(e){return{id:{id:e.id},email:e.email,identifiers:[{identityProviderId:"openlaw",identifier:e.identifiers[0].id}]}}var V=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.appCredsUsername&&a.appCredsPassword&&a.openlawRpcEndpoint&&a.openlawAccountEmail&&a.openlawAccountPassword||a.setState(function(){return{missingConfig:!0}})},a.processNDA=function(){var e=Object(E.a)(g.a.mark(function e(t){var n,r,l,c,o,s,i,f;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({loading:!0}),e.prev=2,a.apiClient.login(a.openLawConfig.userName,a.openLawConfig.password),e.next=6,a.apiClient.getTemplate(a.openLawConfig.templateName);case 6:return n=e.sent,console.log(n),e.next=10,a.apiClient.getUserDetails(a.state.partyAEmail);case 10:return r=e.sent,console.log("partyAOLUser",r),e.next=14,a.apiClient.getUserDetails(a.state.partyBEmail);case 14:if(l=e.sent,console.log("ndaTemplate",n),!(c=U.Openlaw.compileTemplate(n.content)).isError){e.next=19;break}throw"Template error: "+c.errorMessage;case 19:console.log("ctResponse",c),o=a.buildOpenLawParamsObj(n,r,l),s=U.Openlaw.execute(c.compiledTemplate,{},o),i=U.Openlaw.getAgreements(s.executionResult),f=U.Openlaw.renderForReview(i[0].agreement,{}),console.log("html",f),a.setState({step1Active:!1,step1Complete:!0,step2Active:!0,ndaPreviewText:f}),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(2),a.setState({errorMessage:e.t0.toString()}),console.log("exception caught",e.t0);case 32:a.setState({loading:!1});case 33:case"end":return e.stop()}},e,this,[[2,28]])}));return function(t){return e.apply(this,arguments)}}(),a.uploadNDA=function(){var e=Object(E.a)(g.a.mark(function e(t){var n,r,l,c,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({loading:!0}),e.prev=2,a.apiClient.login(a.openLawConfig.userName,a.openLawConfig.password),e.next=6,a.apiClient.getTemplate(a.openLawConfig.templateName);case 6:return n=e.sent,e.next=9,a.apiClient.getUserDetails(a.state.partyAEmail);case 9:return r=e.sent,console.log("partyAOLUser",r),e.next=13,a.apiClient.getUserDetails(a.state.partyBEmail);case 13:return l=e.sent,console.log("ndaTemplate",n),c=a.buildOpenLawParamsObj(n,r,l),console.log("uploadParams",c),e.next=19,a.apiClient.uploadContract(c);case 19:o=e.sent,console.log(o),a.setState({successMessage:"processed",step1Active:!1,step1Complete:!0}),a.setState({ndaModalOpen:!0,ndaAgreementId:o}),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(2),a.setState({errorMessage:e.t0.toString()}),console.log("exception caught",e.t0);case 29:a.setState({loading:!1});case 30:case"end":return e.stop()}},e,this,[[2,25]])}));return function(t){return e.apply(this,arguments)}}(),a.buildOpenLawParamsObj=function(e,t,a){return{templateId:e.id,title:this.openLawConfig.templateName,text:e.content,creator:t.id,parameters:{PartyA:this.state.partyA,PartyB:this.state.partyB,Length:this.state.ndaLength,"PartyA Email":JSON.stringify(B(t)),"PartyA Officer":this.state.partyAOfficer,"PartyA Officer Title":this.state.partyAOfficerTitle,"PartyB Email":JSON.stringify(B(a)),"PartyB Officer":this.state.partyBOfficer,"PartyB Officer Title":this.state.partyBOfficerTitle},overriddenParagraphs:{},agreements:{},readonlyEmails:[],editEmails:[],draftId:""}},a.navigateToNda=Object(E.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open(a.openLawConfig.server+"/contract/"+a.state.ndaAgreementId,"_blank");case 1:case"end":return e.stop()}},e,this)})),a.refreshPage=Object(E.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.reload();case 1:case"end":return e.stop()}},e,this)})),A.bindLocalStorage(Object(y.a)(Object(y.a)(a))),a.openLawConfig={server:A.buildServiceUrlWithCreds(Object(y.a)(Object(y.a)(a)),a.openlawRpcEndpoint),templateName:"NDA DEMO (KALEIDO)",userName:a.openlawAccountEmail,password:a.openlawAccountPassword},a.apiClient=new U.APIClient({root:a.openlawRpcEndpoint,auth:{username:a.appCredsUsername,password:a.appCredsPassword}}),a.state={missingConfig:!1,formLoading:!1,errorMessage:"",successMessage:"",step1Complete:!1,step1Active:!0,step2Active:!1,partyA:"",partyAOfficer:"",partyAOfficerTitle:"",partyAEmail:"",partyB:"",partyBOfficer:"",partyBOfficerTitle:"",partyBEmail:"",ndaLength:"",ndaPreviewText:"",ndaModalOpen:!1,ndaAgreementId:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.missingConfig?r.a.createElement(O,{header:"OpenLaw",text:"be sure to configure the OpenLaw RPC endpoint along with a valid Openlaw account email & password"}):r.a.createElement(k.a,null,r.a.createElement(D.a,{src:"/imgs/top-image.png"}),r.a.createElement(P.a,{as:"h1",attached:"top"},"Create New Joint Venture Project",r.a.createElement("a",{target:"blank",href:"https://github.com/kaleido-io/kaleido-samples-gallery/tree/master/docs/openlaw",style:{marginLeft:"50px",fontSize:"small"}},"view instructions")),r.a.createElement(j.a,{attached:!0},r.a.createElement(P.a.Subheader,null,"New land development, farm exploration, or other joint venture projects"),r.a.createElement(L.a.Group,{ordered:!0},r.a.createElement(L.a,{completed:this.state.step1Complete,active:this.state.step1Active},r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Title,null,"Parties"),r.a.createElement(L.a.Description,null,"Project members"))),r.a.createElement(L.a,{active:this.state.step2Active},r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Title,null,"Non Disclosure"),r.a.createElement(L.a.Description,null,"On OpenLaw"))),r.a.createElement(L.a,null,r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Title,null,"Scope Project"),r.a.createElement(L.a.Description,null,"Success criteria"))),r.a.createElement(L.a,null,r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Title,null,"Budget"))),r.a.createElement(L.a,null,r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Title,null,"Finalize"),r.a.createElement(L.a.Description,null,"On OpenLaw")))),this.state.step1Active&&r.a.createElement(j.a,null,r.a.createElement(F.a,{loading:this.state.formLoading,error:!!this.state.errorMessage,success:!!this.state.successMessage,onSubmit:this.processNDA},r.a.createElement(H.a,{columns:2,divided:!0},r.a.createElement(H.a.Row,{columns:1},r.a.createElement(T.a,{error:!0,header:"Error",content:this.state.errorMessage}),r.a.createElement(T.a,{success:!0,header:"Success",content:this.state.successMessage})),r.a.createElement(H.a.Row,{style:{marginLeft:"0px"}},r.a.createElement(H.a.Column,null,r.a.createElement(P.a,{as:"h4"},"First Participant"),r.a.createElement(F.a.Input,{label:"Company Name",type:"text",placeholder:"Corporate name",onChange:function(t){return e.setState({partyA:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Officer",type:"text",placeholder:"First and last name",onChange:function(t){return e.setState({partyAOfficer:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Title",type:"text",placeholder:"Officer's title (e.g., COO)",onChange:function(t){return e.setState({partyAOfficerTitle:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Email",type:"text",placeholder:"Email address where signature form should be sent",onChange:function(t){return e.setState({partyAEmail:t.target.value})}})),r.a.createElement(H.a.Column,null,r.a.createElement(P.a,{as:"h4"},"Second Participant"),r.a.createElement(F.a.Input,{label:"Company Name",type:"text",placeholder:"Corporate name",onChange:function(t){return e.setState({partyB:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Officer",type:"text",placeholder:"First and last name",onChange:function(t){return e.setState({partyBOfficer:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Title",type:"text",placeholder:"Officer's title (e.g., COO)",onChange:function(t){return e.setState({partyBOfficerTitle:t.target.value})}}),r.a.createElement(F.a.Input,{label:"Email",type:"text",placeholder:"Email address where signature form should be sent",onChange:function(t){return e.setState({partyBEmail:t.target.value})}}))),r.a.createElement(H.a.Row,{columns:1,style:{marginLeft:"0px"}},r.a.createElement(H.a.Column,null,r.a.createElement(F.a.Field,{inline:!0},r.a.createElement("label",null,'How long do you want the non-disclosure agreement ("NDA") to continue after disclosures?'),r.a.createElement(M.a,{placeholder:"years",onChange:function(t){return e.setState({ndaLength:t.target.value})}})))),r.a.createElement(H.a.Row,{columns:1},r.a.createElement(H.a.Column,{textAlign:"right"},r.a.createElement(z.a,{type:"submit",primary:!0},"Go To Non-Disclosure Agreeement")))))),this.state.step2Active&&r.a.createElement(j.a,null,r.a.createElement(P.a,null,"Preview"),r.a.createElement(F.a,{onSubmit:this.uploadNDA,loading:this.state.formLoading,error:!!this.state.errorMessage,success:!!this.state.successMessage},r.a.createElement(H.a,null,r.a.createElement(H.a.Row,{columns:1},r.a.createElement(H.a.Column,{textAlign:"right"},r.a.createElement(z.a,{primary:!0,size:"large"},"Begin Signature Process"))),r.a.createElement(H.a.Row,{columns:1},r.a.createElement(H.a.Column,null,r.a.createElement("div",{className:"ndaPreview",dangerouslySetInnerHTML:{__html:this.state.ndaPreviewText}})),r.a.createElement(H.a.Column,null,"\xa0")))),r.a.createElement(W.a,{open:this.state.ndaModalOpen,closeIcon:!0},r.a.createElement(W.a.Header,null,"Non-Disclosure Agreement"),r.a.createElement(W.a.Content,{image:!0},r.a.createElement(D.a,{src:"/imgs/openlaw-300.png",wrapped:!0,size:"small"}),r.a.createElement(W.a.Description,null,r.a.createElement("p",null,"You will now be redirected to OpenLaw where both parties will execute the NDA. Evidence of the agreement will be stored on the blockchain."),r.a.createElement(z.a,{primary:!0,onClick:this.navigateToNda},"Sign NDA On OpenLaw"),r.a.createElement(z.a,{style:{marginLeft:"50px"},default:!0,onClick:this.refreshPage},"close & conclude demo"))))),r.a.createElement(j.a,null,r.a.createElement("p",null,"Agriculture Network is a demonstration project by ",r.a.createElement("strong",null,r.a.createElement("a",{href:"http://openlaw.io"},"OpenLaw ")),"and ",r.a.createElement("strong",null,r.a.createElement("a",{href:"https://kaleido.io"},"Kaleido")),"."))))}}]),t}(n.Component),J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.appCredsUsername&&a.appCredsPassword&&a.nodeRpcEndpoint&&a.idRegistryRpcEndpoint||a.setState(function(){return{missingConfig:!0}})},a.fetchDirectory=function(){a.setState(function(){return{fetchingDirectory:!0}},function(){var e=new Headers;e.append("Authorization","Basic "+btoa(a.appCredsUsername+":"+a.appCredsPassword)),e.append("Accept","application/json, text/plain, */*");var t="".concat(a.idRegistryRpcEndpoint,"/api/v1/directories");fetch(t,{method:"GET",headers:e}).then(function(e){return e.json()}).then(function(e){var t=e[0];a.setState(function(){return{directoryContractAddress:t.directory}})})})},A.bindLocalStorage(Object(y.a)(Object(y.a)(a))),A.buildWeb3(Object(y.a)(Object(y.a)(a))),a.state={missingConfig:!1,fetchingDirectory:!1,directoryContractAddress:""},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.missingConfig?r.a.createElement(O,{header:"ID Registry"}):r.a.createElement("main",{className:"container"},r.a.createElement("h2",null,"ID Registry"),r.a.createElement("h5",null,"The purpose of this sample is to show how you can use Kaleido's ID Registry service to create an organization and add users to that organization."),r.a.createElement("br",null),this.state.directoryContractAddress?r.a.createElement("div",null,r.a.createElement("h6",null,"The directories contract has been deployed to the following address: ",r.a.createElement("i",null,this.state.directoryContractAddress),"."),r.a.createElement("h6",null,"Next up: let's bind your verified organizational identity (i.e. the validated x509 cert) with an Ethereum account and establish an on-chain organizational identity")):r.a.createElement("div",null,r.a.createElement("h6",null,"Fetch directory contract address from ID Registry service"),r.a.createElement("div",{className:"col-sm-5"},r.a.createElement("button",{disabled:this.state.fetchingDirectory,type:"button",className:"btn btn-primary",onClick:function(){return e.fetchDirectory()}},"Get contract address"))))}}]),t}(n.Component),K=a(86),G=a(193),_=a(344),q=a.n(_),Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.appCredsUsername&&a.appCredsPassword&&a.nodeRpcEndpoint?a.state.contractAddress&&a.getNumberOfRecords():a.setState(function(){return{missingConfig:!0}})},a.deployingContract=function(){a.setState(function(){return{modifyingContract:!0}},function(){return a.deployContract()})},a.msgChanged=function(e){var t=e.target.value;a.setState(function(){return{msg:t,validMsg:a.isJSON(t)}})},a.isJSON=function(e){if("string"!==typeof e)return!1;try{return JSON.parse(e),!0}catch(t){return!1}},a.addMsg=function(){a.setState(function(){return{addingMsg:!0}},Object(E.a)(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.getContract(a.web3,K,a.state.contractAddress,[]),e.next=3,a.web3.eth.personal.getAccounts();case 3:return n=e.sent,r={from:n[0],gas:5e6},e.next=7,t.methods.push(n[0],a.state.msg).send(r).on("error",function(e){console.error("Failed to call the smart contract. Error: "+e)}).then(function(e){console.log(e),a.setState(function(){return{msg:"",addingMsg:!1,validMsg:!1,auditRecordCount:a.state.auditRecordCount+1}},function(){return a.fetchRecord(a.state.auditRecordCount-1)})});case 7:case"end":return e.stop()}},e,this)})))},a.fetchRecord=function(e){a.setState(function(){return{fetchingRecord:!0,viewJsonMessage:"Fetching record #".concat(e+1,"...")}},Object(E.a)(g.a.mark(function t(){var n,r;return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=A.getContract(a.web3,K,a.state.contractAddress,[]),t.next=3,n.methods.logEntries(e).call();case 3:r=t.sent,a.setState(function(){return{viewRecordId:e+1,viewPrettyJson:r.payload,viewRecordEntityAddress:r.entityAddress,fetchingRecord:!1}});case 5:case"end":return t.stop()}},t,this)})))},a.editingContract=function(){a.setState(function(){return{showEditingContract:!a.state.showEditingContract}})},a.clearContract=function(){a.setState(function(){return{modifyingContract:!0}},function(){localStorage.removeItem("auditLogContractAddress"),window.location.reload()})},a.changeContractAddress=function(){a.setState(function(){return{modifyingContract:!0}},function(){A.getContract(a.web3,K,a.state.editContractAddress,[])||(alert("invalid contract address"),a.setState(function(){return{modifyingContract:!1}})),localStorage.setItem("auditLogContractAddress",a.state.editContractAddress),window.location.reload()})},a.editContractAddressChanged=function(e){var t=e.target.value;a.setState(function(){return{editContractAddress:t,editContractAddressValid:t.startsWith("0x")&&42===t.length}})},a.editContractPanel=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("button",{className:"btn btn-sm btn-link",onClick:function(){return a.editingContract()}},"load a previously deployed contract")),a.state.showEditingContract?r.a.createElement("div",null,r.a.createElement("small",{className:"col-sm-12"},"load a previously deployed contract, or, clear the above loaded contract from local storage so you can start over and deploy a brand new one"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Audit log contract address"),r.a.createElement("div",{className:"col-sm-5"},r.a.createElement("input",{disabled:a.state.modifyingContract,type:"text",className:"form-control",onChange:a.editContractAddressChanged})),r.a.createElement("div",{className:"col-sm-5"},r.a.createElement("button",{disabled:!a.state.editContractAddressValid||a.state.modifyingContract,type:"button",className:"btn btn-sm btn-primary",onClick:function(){return a.changeContractAddress()}},"load contract"),a.state.contractExistsInLocalStorage?r.a.createElement("small",{style:{marginLeft:"15px"}},"or"):null,a.state.contractExistsInLocalStorage?r.a.createElement("button",{style:{marginLeft:"15px"},type:"button",className:"btn btn-sm btn-warning",disabled:a.state.modifyingContract,onClick:function(){return a.clearContract()}},"clear current contract"):null))):null)},A.bindLocalStorage(Object(y.a)(Object(y.a)(a))),A.buildWeb3(Object(y.a)(Object(y.a)(a))),a.state={missingConfig:!1,contractExistsInLocalStorage:!!localStorage.getItem("auditLogContractAddress"),contractAddress:localStorage.getItem("auditLogContractAddress"),validMsg:!1,msg:"",addingMsg:!1,auditRecordCount:0,viewRecordId:0,viewRecordEntityAddress:"",viewPrettyJson:"",viewJsonMessage:"click record on left to view transaction details",showEditingContract:!1,editContractAddress:"",editContractAddressValid:!1,modifyingContract:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getNumberOfRecords",value:function(){var e=Object(E.a)(g.a.mark(function e(){var t,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.getContract(this.web3,K,this.state.contractAddress,[]),e.next=3,t.methods.getSize().call();case 3:a=e.sent,this.setState(function(){return{auditRecordCount:Number.parseInt(a)}});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deployContract",value:function(){var e=Object(E.a)(g.a.mark(function e(){var t,a,n,r,l=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.web3.eth.personal.getAccounts();case 2:t=e.sent,a=A.getContract(this.web3,K,"",[]),n=a.encodeABI(),r={from:t[0],gas:5e8,data:n},this.web3.eth.sendTransaction(r).on("receipt",function(e){console.log(e)}).on("error",function(e){console.error("Failed to deploy the smart contract. Error: "+e)}).then(function(e){console.log(e),console.log("\tSmart contract deployed, ready to take calls at '".concat(e.contractAddress,"'")),l.setState(function(){return{contractAddress:e.contractAddress,contractExistsInLocalStorage:!0,modifyingContract:!1}},function(){return localStorage.setItem("auditLogContractAddress",e.contractAddress)})});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderTimelines",value:function(){for(var e=this,t=[],a=100,n=function(a){var n=a%2===0?"#03a9f4":"#6fba1c";t.push(r.a.createElement("div",{key:a+1,style:{cursor:"pointer"},onClick:function(){return e.fetchRecord(a)}},r.a.createElement(G.TimelineBlip,{title:"#".concat(a+1),iconColor:n})))},l=this.state.auditRecordCount-1;l>=0&&a>0;l--,a--)n(l);return t}},{key:"render",value:function(){var e=this;if(this.state.missingConfig)return r.a.createElement(O,{header:"Audit Log"});return r.a.createElement("main",{className:"container"},r.a.createElement("h2",null,"Audit Log"),r.a.createElement("h5",null,"The purpose of this sample is to show how you can use a simple smart contract as an audit log to view records as they're submitted over time."),r.a.createElement("br",null),this.state.contractExistsInLocalStorage?null:r.a.createElement("div",null,r.a.createElement("h6",null,"Step 1: Deploy a new audit log contract to track log records going forward, or, specify a previously deployed audit log contract"),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{type:"button",className:"btn btn-success",disabled:this.state.modifyingContract,onClick:function(){return e.deployingContract()}},this.state.modifyingContract?"Deploying to blockchain...":"Deploy to blockchain!")),r.a.createElement("small",null,"or"),this.editContractPanel()),this.state.contractAddress?r.a.createElement("div",null,r.a.createElement("h6",null,"The audit log smart contract has been deployed to the following address:",r.a.createElement("i",null," ",this.state.contractAddress),".",r.a.createElement("br",null),this.editContractPanel()),r.a.createElement("br",null),r.a.createElement("h6",null,"Add new log record by calling a function on the smart contract"),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"JSON payload"),r.a.createElement("div",{className:"col-sm-7"},r.a.createElement("textarea",{disabled:this.state.addingMsg,onChange:this.msgChanged,className:"form-control",rows:"3",value:this.state.msg})),r.a.createElement("div",{className:"col-sm-3"},r.a.createElement("button",{disabled:this.state.addingMsg||!this.state.validMsg,type:"button",className:"btn btn-primary",onClick:function(){return e.addMsg()}},this.state.addingMsg?"Adding...":"Add"),this.state.msg&&!this.state.validMsg?" invalid json ":"")),this.state.auditRecordCount>0?r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("h6",null,"Audit log history (most recent records appear at top)"),r.a.createElement("br",null),r.a.createElement("div",{className:"row col-sm-12"},r.a.createElement("div",{style:{overflowY:"scroll",maxHeight:"500px",borderRight:"1px solid rgba(0,0,0,.1)"},className:"col-sm-3"},r.a.createElement(G.Timeline,null,this.renderTimelines())),r.a.createElement("div",{className:"col-sm-8"},!this.state.fetchingRecord&&this.state.viewRecordId>0?r.a.createElement("div",null,r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Record #"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext",value:this.state.viewRecordId}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Entity address"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext",value:this.state.viewRecordEntityAddress}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Payload"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement(q.a,{id:"json-pretty",json:this.state.viewPrettyJson,className:"form-control-plaintext"})))):r.a.createElement("div",null,this.state.viewJsonMessage)))):null):null)}}]),t}(n.Component),$=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,{basename:"/kaleido-samples-gallery"},r.a.createElement("div",null,r.a.createElement("header",{className:""},r.a.createElement("div",null,r.a.createElement(u.a,{to:"/"},r.a.createElement("button",{className:"btn btn-link"},"Configure")),r.a.createElement(u.a,{to:"/hdwallet"},r.a.createElement("button",{className:"btn btn-link"},"HDWallet")),r.a.createElement(u.a,{to:"/ipfs"},r.a.createElement("button",{className:"btn btn-link"},"IPFS")),r.a.createElement(u.a,{to:"/idregistry"},r.a.createElement("button",{className:"btn btn-link"},"ID Registry")),r.a.createElement(u.a,{to:"/openlaw"},r.a.createElement("button",{className:"btn btn-link"},"OpenLaw")),r.a.createElement(u.a,{to:"/auditlog"},r.a.createElement("button",{className:"btn btn-link"},"Audit Log")))),r.a.createElement("hr",null),r.a.createElement("div",null,r.a.createElement(p.a,{exact:!0,path:"/",component:b}),r.a.createElement(p.a,{exact:!0,path:"/hdwallet",component:x}),r.a.createElement(p.a,{exact:!0,path:"/ipfs",component:R}),r.a.createElement(p.a,{exact:!0,path:"/idregistry",component:J}),r.a.createElement(p.a,{exact:!0,path:"/openlaw",component:V}),r.a.createElement(p.a,{exact:!0,path:"/auditlog",component:Y}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},86:function(e){e.exports={abi:'[{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"logEntries","outputs":[{"name":"entityAddress","type":"address"},{"name":"payload","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"entityAddress","type":"address"},{"name":"payload","type":"string"}],"name":"push","outputs":[{"name":"rowNumber","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getSize","outputs":[{"name":"size","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}]',bytecode:"608060405234801561001057600080fd5b50610438806100206000396000f3006080604052600436106100565763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166388702ee9811461005b578063cf62fd391461011e578063de8fa431146101a4575b600080fd5b34801561006757600080fd5b506100736004356101b9565b604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b838110156100e25781810151838201526020016100ca565b50505050905090810190601f16801561010f5780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b34801561012a57600080fd5b5060408051602060046024803582810135601f810185900485028601850190965285855261019295833573ffffffffffffffffffffffffffffffffffffffff169536956044949193909101919081908401838280828437509497506102899650505050505050565b60408051918252519081900360200190f35b3480156101b057600080fd5b50610192610355565b60008054829081106101c757fe5b600091825260209182902060029182020180546001808301805460408051601f6000199584161561010002959095019092169690960492830187900487028101870190955281855273ffffffffffffffffffffffffffffffffffffffff9092169550919390919083018282801561027f5780601f106102545761010080835404028352916020019161027f565b820191906000526020600020905b81548152906001019060200180831161026257829003601f168201915b5050505050905082565b600061029361035c565b73ffffffffffffffffffffffffffffffffffffffff8481168252602080830185815260008054600180820180845592805286517f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5636002909302928301805473ffffffffffffffffffffffffffffffffffffffff19169190971617865592518051939592948794610349937f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e564019290910190610374565b50505003949350505050565b6000545b90565b60408051808201909152600081526060602082015290565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106103b557805160ff19168380011785556103e2565b828001600101855582156103e2579182015b828111156103e25782518255916020019190600101906103c7565b506103ee9291506103f2565b5090565b61035991905b808211156103ee57600081556001016103f85600a165627a7a723058200362a17e8bced802068bfe6d4a00833614ef6fd4e907bb9039b01a8e5257218c0029",functionHashes:{"getSize()":"de8fa431","logEntries(uint256)":"88702ee9","push(address,string)":"cf62fd39"},gasEstimates:{creation:[257,216e3],external:{"getSize()":429,"logEntries(uint256)":null,"push(address,string)":null},internal:{}},runtimeBytecode:"6080604052600436106100565763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166388702ee9811461005b578063cf62fd391461011e578063de8fa431146101a4575b600080fd5b34801561006757600080fd5b506100736004356101b9565b604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b838110156100e25781810151838201526020016100ca565b50505050905090810190601f16801561010f5780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b34801561012a57600080fd5b5060408051602060046024803582810135601f810185900485028601850190965285855261019295833573ffffffffffffffffffffffffffffffffffffffff169536956044949193909101919081908401838280828437509497506102899650505050505050565b60408051918252519081900360200190f35b3480156101b057600080fd5b50610192610355565b60008054829081106101c757fe5b600091825260209182902060029182020180546001808301805460408051601f6000199584161561010002959095019092169690960492830187900487028101870190955281855273ffffffffffffffffffffffffffffffffffffffff9092169550919390919083018282801561027f5780601f106102545761010080835404028352916020019161027f565b820191906000526020600020905b81548152906001019060200180831161026257829003601f168201915b5050505050905082565b600061029361035c565b73ffffffffffffffffffffffffffffffffffffffff8481168252602080830185815260008054600180820180845592805286517f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5636002909302928301805473ffffffffffffffffffffffffffffffffffffffff19169190971617865592518051939592948794610349937f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e564019290910190610374565b50505003949350505050565b6000545b90565b60408051808201909152600081526060602082015290565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106103b557805160ff19168380011785556103e2565b828001600101855582156103e2579182015b828111156103e25782518255916020019190600101906103c7565b506103ee9291506103f2565b5090565b61035991905b808211156103ee57600081556001016103f85600a165627a7a723058200362a17e8bced802068bfe6d4a00833614ef6fd4e907bb9039b01a8e5257218c0029"}}},[[357,2,1]]]);
//# sourceMappingURL=main.a2aa370e.chunk.js.map